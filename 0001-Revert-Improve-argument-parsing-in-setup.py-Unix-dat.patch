From bbbcc642a553f8cb9ac7a44f0b003e065879b27b Mon Sep 17 00:00:00 2001
From: Marcel O'Neil <marcel@marceloneil.com>
Date: Wed, 25 Apr 2018 12:50:45 -0400
Subject: [PATCH] Revert "Improve argument parsing in `setup.py` Unix data file
 injection hack"

This reverts commit e10c1df8bb5394f8254a0a3465d5270890d1fdd6.
---
 setup.py | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/setup.py b/setup.py
index 8d1313d5..bf9fe66a 100755
--- a/setup.py
+++ b/setup.py
@@ -23,12 +23,12 @@ if sys.version_info[:3] < (3, 5, 0):
 data_files = []
 
 if platform.system() in ['Linux', 'FreeBSD', 'DragonFly']:
-    parser = argparse.ArgumentParser(add_help=False)
+    parser = argparse.ArgumentParser()
     parser.add_argument('--root=', dest='root_path', metavar='dir', default='/')
-    parser.add_argument('--prefix=', dest='prefix_path', metavar='prefix', default=sys.prefix)
     opts, _ = parser.parse_known_args(sys.argv[1:])
-    usr_share = os.path.join(opts.root_path + opts.prefix_path, "share")
-    if not os.access(usr_share, os.W_OK):
+    usr_share = os.path.join(sys.prefix, "share")
+    if not os.access(opts.root_path + usr_share, os.W_OK) and \
+       not os.access(opts.root_path, os.W_OK):
         if 'XDG_DATA_HOME' in os.environ.keys():
             usr_share = os.environ['XDG_DATA_HOME']
         else:
-- 
2.17.0

